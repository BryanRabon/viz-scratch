packages:
  - sp
  - maps
  - maptools
  - rgeos 
  - stringr
  - dataRetrieval
  - lubridate
  - dplyr
  - mapdata
  - jsonlite

sources:
  - R/map_utils.R
  - R/data_utils.R
  - R/draw_utils.R
  
targets:
  all: 
    depends: 
      - figures/01_CA_water_use_pie0.png
      - figures/02_CA_water_use_irrigation0.png
      - figures/03_CA_water_use_thermoelectric0.png
      - figures/04_CA_water_use_publicsupply0.png
  # fetch http://stateplane.ret3.net/COUNTYSPC.XLS?     
  
  plot_metadata:
    command: c(I(7), I(5), I(400))
  
  CA_proj:
    command: c(I("+proj=utm +zone=10 ellps=WGS84"))
  
  CA_counties:
    command: to_sp(I('county'), I('California'), proj.string = CA_proj)
  
  CA_state:
    command: to_sp(I('state'), I('California'), proj.string = CA_proj)
    
  CA_county_dots:
    command: get_dots('../../water-use-15/cache/county_centroids_wu.json', CA_proj, I("CA"))
  
  figures/01_CA_water_use_pie0.png:
    command: plot_pie_transitions(CA_state, CA_counties, CA_county_dots, plot_metadata, 'images/usgs_logo_black.png', 
      target_name, I('irrigation'), I(7))
    
  figures/02_CA_water_use_irrigation0.png:
    command: plot_dot_transitions(CA_state, CA_counties, CA_county_dots, plot_metadata, 'images/usgs_logo_black.png', 
      target_name, I('irrigation'), I("thermoelectric"), I(7))
      
  figures/03_CA_water_use_thermoelectric0.png:
    command: plot_dot_transitions(CA_state, CA_counties, CA_county_dots, plot_metadata, 'images/usgs_logo_black.png', 
      target_name, I("thermoelectric"), I('publicsupply'), I(7))
      
  figures/04_CA_water_use_publicsupply0.png:
    command: plot_pie_transitions(CA_state, CA_counties, CA_county_dots, plot_metadata, 'images/usgs_logo_black.png', 
      target_name, I('publicsupply'), I(7))
    
    
  